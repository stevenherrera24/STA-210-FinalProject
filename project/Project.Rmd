---
title: "Project"
author: "Steven Herrera and Ethan Shen"
date: "11/09/2018"
output:
  html_document: default
  pdf_document: default
---

```{r load-packages, message=FALSE}
library(tidyverse)
library(olsrr)
library(cowplot)
library(car)
library(broom)
library(knitr)
```

```{r message=FALSE, include=FALSE}
atp <- read_csv("files/atp.csv")
atp2016 <- read_csv("files/atp2016.csv")
atp2015 <- read_csv("files/atp2015.csv")
atp2014 <- read_csv("files/atp2014.csv")
atp2013 <- read_csv("files/atp2013.csv")
atp2012 <- read_csv("files/atp2012.csv")
atp2011 <- read_csv("files/atp2011.csv")
atp2010 <- read_csv("files/atp2010.csv")

atp1 <- atp %>%
  filter(tourney_date < 20171113)

winners2017 <- atp1 %>%
  filter(round == "F")

winners2016 <- atp2016 %>%
  filter(tourney_date < 20161114) %>%
  filter(round == "F")

winners2015 <- atp2015 %>%
  filter(tourney_date < 20151115) %>%
  filter(round == "F")

winners2014 <- atp2014 %>%
  filter(tourney_date < 20141109) %>%
  filter(round == "F")

winners2013 <- atp2013 %>%
  filter(tourney_date < 20131104) %>%
  filter(round == "F")

winners2012 <- atp2012 %>%
  filter(tourney_date < 20121105) %>%
  filter(round == "F")

winners2011 <- atp2011 %>%
  filter(tourney_date < 20111114) %>%
  filter(round == "F")

winners2010 <- atp2010 %>%
  filter(tourney_date < 20101121) %>%
  filter(round == "F")

winners <- rbind(winners2017, winners2016, winners2015, winners2014, winners2013, 
                 winners2012, winners2011, winners2010)

winners_set <- winners %>%
  filter(best_of == 3,
         !is.na(w_ace), 
         !is.na(w_df), 
         !is.na(w_svpt), 
         !is.na(w_1stIn), 
         !is.na(w_1stWon), 
         !is.na(w_2ndWon),
         !is.na(w_SvGms), 
         !is.na(w_bpSaved),
         !is.na(w_bpFaced)) %>%
  group_by(winner_name) %>%
  mutate(mean_w_ace = mean(w_ace),
         mean_w_df = mean(w_df),
         mean_w_svpt = mean(w_svpt),
         mean_w_1stIn = mean(w_1stIn),
         mean_w_1stWon = mean(w_1stWon),
         mean_w_2ndWon = mean(w_2ndWon),
         mean_w_SvGms = mean(w_SvGms),
         mean_w_bpSaved = mean(w_bpSaved),
         mean_w_bpFaced = mean(w_bpFaced),
         mean_minutes = mean(minutes),
         num = n())

myvars <- names(winners_set) %in% c("loser_id", "loser_seed", "loser_entry", "loser_name",
                             "loser_hand", "loser_ht", "loser_ioc", "loser_age", 
                             "loser_rank", "loser_rank_points", "l_ace", "l_df", 
                             "l_svpt", "l_1stIn", "l_1stWon", "l_2ndWon", "l_SvGms", 
                             "l_bpSaved", "l_bpFaced") 
winners_set <- winners_set[!myvars]
```


# Exploratory Data Analysis 

To begin our exploratory data analysis, we will examine the matrix plots for all three court surfaces, with the response variable being `num` and all other variables we deemed important in our proposal.

## Matrix Plot
```{r fig.height=11, fig.width=11}
pairs(num ~ winner_seed + winner_ht + winner_age + winner_rank + 
        mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_1stWon + 
        mean_w_2ndWon + mean_w_SvGms + mean_w_bpSaved + mean_w_bpFaced + 
        mean_minutes, data=winners_set, pch = 16,
      main = "Matrix of scatterplots for Tournament Wins and Variables")
```
# Linear Regression

To begin our regression models, we will

```{r}
hardcourtmodel <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + 
        mean_w_df + mean_w_svpt + mean_w_bpSaved, data=hard)
claycourtmodel <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + 
        mean_w_df + mean_w_svpt + mean_w_bpSaved, data=clay)
grasscourtmodel <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + 
        mean_w_df + mean_w_svpt + mean_w_bpSaved, data=grass)
```

```{r}
#backward <- ols_step_backward_aic(testmodel)
```

# Linear Regression Assumptions

# Hypothesis Tests + Confidence Intervals

# Conclusion



















































## Hard

```{r}
testhard <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpSaved + mean_w_bpFaced + mean_minutes, data = hard)
```

```{r}
backward <- ols_step_backward_aic(testhard)
```

```{r}
testhardnew <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + mean_w_svpt + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpFaced + mean_minutes, data = hard)
tidy(testhardnew)
```

```{r}
pairs(num ~ winner_seed + winner_ht + winner_age + winner_rank + mean_w_svpt + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpFaced + mean_minutes, data = hard)
```

## Clay

```{r}
testclay <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpSaved + mean_w_bpFaced + mean_minutes, data = clay)
tidy(testclay)
```

```{r}
backward <- ols_step_backward_aic(testclay)
```

```{r}
testclaynew <- lm(num ~ winner_seed + winner_ht + winner_rank + mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_SvGms + mean_w_bpSaved +  mean_minutes, data = clay)
tidy(testclaynew)
```

```{r}
pairs(num ~ winner_seed + winner_ht + winner_rank + mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_SvGms + mean_w_bpSaved +  mean_minutes, data = clay)
```

## Grass

```{r}
testgrass <- lm(num ~ winner_seed + winner_ht + winner_age + winner_rank + mean_w_df + mean_w_svpt + mean_w_1stIn + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpSaved + mean_w_bpFaced + mean_minutes, data = grass)
tidy(testgrass)
```

```{r}
backward <- ols_step_backward_aic(testgrass)
```

```{r}
testgrassnew <- lm(num ~ winner_seed + winner_ht + winner_rank + mean_w_svpt + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpFaced + mean_minutes, data = hard)
tidy(testgrassnew)
```

```{r}
pairs(num ~ winner_seed + winner_ht + winner_rank + mean_w_svpt + mean_w_1stWon + mean_w_2ndWon + mean_w_SvGms + mean_w_bpFaced + mean_minutes, data = hard)
```



































































